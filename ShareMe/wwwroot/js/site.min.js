var FollowingsService=function(){var follow=function(followeeId,done,fail){$.post("/api/followings/add/"+followeeId).done(done).fail(fail)},unfollow=function(followeeId,done,fail){$.ajax({url:"/api/followings/delete/"+followeeId,method:"DELETE"}).done(done).fail(fail)};return{follow:follow,unfollow:unfollow}}(),RatingsService=function(){var like=function(photoId,done,fail){$.post("/api/photos/like/"+photoId).done(done).fail(fail)},dislike=function(photoId,done,fail){$.ajax({url:"/api/photos/dislike/"+photoId,method:"DELETE"}).done(done).fail(fail)},getLikers=function(photoId,done,fail){$.get("/api/photos/GetLikers/"+photoId).done(done).fail(fail)};return{like:like,dislike:dislike,getLikers:getLikers}}(),PhotoDetailsController=function(followingService,ratingService){var button,likeImg,photoId,doneFollowing=function(){var text=button.text().trim()==="Following"?"Follow":"Following";button.toggleClass("btn-default").toggleClass("btn-info").text(text)},doneLike=function(){var count=parseInt($("#likes").html());$("#likes").html(count+1);$(likeImg).attr("liked","1");$(likeImg).css("color","red")},doneDislike=function(){var count=parseInt($("#likes").html());$("#likes").html(count-1);$(likeImg).removeAttr("liked");$(likeImg).css("color","black")},showLikers=function(response){$("#modal-content").html(response);$("#myModal").modal("show")},fail=function(){alert("Something failed!")},toggleFollowing=function(e){button=$(e.target);var userId=button.attr("data-user-id");button.hasClass("btn-info")?followingService.follow(userId,doneFollowing,fail):followingService.unfollow(userId,doneFollowing,fail)},toggleLike=function(){likeImg=$("#like-img");$(likeImg)[0].hasAttribute("liked")?ratingService.dislike(photoId,doneDislike,fail):ratingService.like(photoId,doneLike,fail)},getLikes=function(){ratingService.getLikers(photoId,showLikers,fail)},init=function(){photoId=$("#data").attr("data-photo-id");$(".js-toggle-following").click(toggleFollowing);$("#like").click(toggleLike);$("#likes").click(getLikes)};return{init:init}}(FollowingsService,RatingsService);